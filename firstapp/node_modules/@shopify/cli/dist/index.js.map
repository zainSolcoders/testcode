{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["// CLI\nimport {run, settings, flush} from '@oclif/core'\nimport Bugsnag from '@bugsnag/js'\nimport {error as kitError, environment} from '@shopify/cli-kit'\n\nfunction runCLI() {\n  if (environment.local.isDebug()) {\n    settings.debug = true\n  } else {\n    Bugsnag.start({apiKey: '9e1e6889176fd0c795d5c659225e0fae', logger: null})\n  }\n\n  run(undefined, import.meta.url)\n    .then(flush)\n    .catch((error: Error): Promise<void | Error> => {\n      if (error instanceof kitError.AbortSilent) {\n        process.exit(1)\n      }\n      const bugsnagHandle = async (errorToReport: Error): Promise<Error> => {\n        if (!settings.debug) {\n          await new Promise((resolve, reject) => {\n            Bugsnag.notify(errorToReport, undefined, resolve)\n          })\n        }\n        return Promise.resolve(errorToReport)\n      }\n      const kitMapper = kitError.mapper\n      const kitHandle = kitError.handler\n      // eslint-disable-next-line promise/no-nesting\n      return kitMapper(error)\n        .then(bugsnagHandle)\n        .then((error: Error) => {\n          kitHandle(error)\n        })\n    })\n}\n\nexport default runCLI\n"],"names":["error","kitError"],"mappings":";;;;AAKA,SAAkB,MAAA,GAAA;AAChB,EAAI,IAAA,WAAA,CAAY,KAAM,CAAA,OAAA,EAAW,EAAA;AAC/B,IAAA,QAAA,CAAS,KAAQ,GAAA,IAAA,CAAA;AAAA,GACZ,MAAA;AACL,IAAA,OAAA,CAAQ,MAAM,EAAC,MAAA,EAAQ,kCAAoC,EAAA,MAAA,EAAQ,MAAK,CAAA,CAAA;AAAA,GAC1E;AAEA,EAAI,GAAA,CAAA,KAAA,CAAA,EAAW,YAAY,GAAG,CAAA,CAC3B,KAAK,KAAK,CAAA,CACV,KAAM,CAAA,CAACA,OAAwC,KAAA;AAC9C,IAAI,IAAAA,OAAA,YAAiBC,MAAS,WAAa,EAAA;AACzC,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA,CAAA;AAAA,KAChB;AACA,IAAM,MAAA,aAAA,GAAgB,OAAO,aAAyC,KAAA;AACpE,MAAI,IAAA,CAAC,SAAS,KAAO,EAAA;AACnB,QAAA,MAAM,IAAI,OAAA,CAAQ,CAAC,OAAA,EAAS,MAAW,KAAA;AACrC,UAAQ,OAAA,CAAA,MAAA,CAAO,aAAe,EAAA,KAAA,CAAA,EAAW,OAAO,CAAA,CAAA;AAAA,SACjD,CAAA,CAAA;AAAA,OACH;AACA,MAAO,OAAA,OAAA,CAAQ,QAAQ,aAAa,CAAA,CAAA;AAAA,KACtC,CAAA;AACA,IAAA,MAAM,YAAYA,KAAS,CAAA,MAAA,CAAA;AAC3B,IAAA,MAAM,YAAYA,KAAS,CAAA,OAAA,CAAA;AAE3B,IAAO,OAAA,SAAA,CAAUD,OAAK,CACnB,CAAA,IAAA,CAAK,aAAa,CAClB,CAAA,IAAA,CAAK,CAAC,MAAiB,KAAA;AACtB,MAAA,SAAA,CAAU,MAAK,CAAA,CAAA;AAAA,KAChB,CAAA,CAAA;AAAA,GACJ,CAAA,CAAA;AACL;;;;"}